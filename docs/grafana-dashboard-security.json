{
  "id": null,
  "uid": "converto-security-ops",
  "title": "Converto Security — Operations",
  "tags": ["converto", "security", "ops"],
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "editable": true,
  "refresh": "30s",
  "time": { "from": "now-24h", "to": "now" },
  "templating": {
    "list": [
      { "name": "ds", "type": "datasource", "query": "prometheus", "label": "Datasource", "current": { "text": "Prometheus", "value": "Prometheus" } },
      { "name": "tenant", "type": "query", "label": "Tenant", "datasource": { "type": "prometheus", "uid": "$ds" }, "query": "label_values(login_failure_total, tenant)", "refresh": 1, "hide": 0, "multi": true, "includeAll": true, "current": { "text": "All", "value": "$__all" } },
      { "name": "interval", "type": "interval", "label": "Rate interval", "query": "1m,5m,10m", "current": { "text": "5m", "value": "5m" } }
    ]
  },
  "annotations": {
    "list": [
      { "name": "Prometheus Alerts", "type": "dashboard", "enable": true, "iconColor": "rgba(255, 96, 96, 1)", "datasource": { "type": "prometheus", "uid": "$ds" }, "expr": "ALERTS{alertstate=\"firing\",alertname=~\"Security.*\"}", "titleFormat": "{{alertname}}", "textFormat": "state={{alertstate}}", "tagKeys": "alertname,severity" }
    ]
  },
  "panels": [
    { "type": "stat", "title": "Active suppressions (alerts_status_count)", "gridPos": { "x": 0, "y": 0, "w": 6, "h": 6 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "options": { "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal" }, "fieldConfig": { "defaults": { "unit": "none", "thresholds": { "mode": "absolute", "steps": [ { "color": "green" }, { "color": "yellow", "value": 1 }, { "color": "red", "value": 10 } ] } }, "overrides": [] }, "targets": [ { "refId": "A", "expr": "alerts_status_count" } ] },
    { "type": "timeseries", "title": "Suppression Events (binary, 5m window)", "gridPos": { "x": 6, "y": 0, "w": 18, "h": 6 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "fieldConfig": { "defaults": { "unit": "none" }, "overrides": [] }, "options": { "legend": { "showLegend": false }, "tooltip": { "mode": "single" }, "lineWidth": 2, "fillOpacity": 20 }, "targets": [ { "refId": "A", "expr": "max_over_time((alerts_status_count > 0)[5m])", "legendFormat": "active(0/1)" } ] },
    { "type": "timeseries", "title": "Login failures rate by tenant (rate(login_failure_total[$interval]))", "gridPos": { "x": 0, "y": 6, "w": 12, "h": 9 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "fieldConfig": { "defaults": { "unit": "req/s" }, "overrides": [] }, "options": { "legend": { "showLegend": true, "placement": "bottom" }, "tooltip": { "mode": "multi" }, "lineWidth": 2, "fillOpacity": 15 }, "targets": [ { "refId": "A", "expr": "sum by (tenant) (rate(login_failure_total{tenant=~\"$tenant\"}[$interval]))", "legendFormat": "{{tenant}}" } ] },
    { "type": "timeseries", "title": "Feature access denied rate by tenant (rate(feature_access_denied_total[$interval]))", "gridPos": { "x": 12, "y": 6, "w": 12, "h": 9 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "fieldConfig": { "defaults": { "unit": "req/s" }, "overrides": [] }, "options": { "legend": { "showLegend": true, "placement": "bottom" }, "tooltip": { "mode": "multi" }, "lineWidth": 2, "fillOpacity": 15 }, "targets": [ { "refId": "A", "expr": "sum by (tenant) (rate(feature_access_denied_total{tenant=~\"$tenant\"}[$interval]))", "legendFormat": "{{tenant}}" } ] },
    { "type": "timeseries", "title": "Alerts Status Trend (alerts_status_count)", "gridPos": { "x": 0, "y": 15, "w": 24, "h": 8 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "fieldConfig": { "defaults": { "unit": "none" }, "overrides": [] }, "options": { "legend": { "showLegend": false }, "tooltip": { "mode": "single" }, "lineWidth": 2, "fillOpacity": 10 }, "targets": [ { "refId": "A", "expr": "alerts_status_count", "legendFormat": "dedupe entries" } ] },
    { "type": "logs", "title": "Security alerts & anomalies (annotations-correlated)", "gridPos": { "x": 0, "y": 23, "w": 24, "h": 7 }, "datasource": { "type": "prometheus", "uid": "$ds" }, "options": { "dedupStrategy": "none", "enableLogDetails": false, "showTime": true, "wrapLogMessage": true }, "targets": [ { "refId": "A", "expr": "ALERTS{alertstate=\"firing\",alertname=~\"Security.*\"}" } ], "description": "Näyttää Prometheus‑alertit, jotka on nimetty Security‑prefiksillä; toimii korrelaationa failure/denied raten ja suppression‑tapahtumien kanssa." }
  ]
}


